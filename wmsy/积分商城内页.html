<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0">
<meta charset="utf-8">
<title></title>
<script>
(function (doc, win) {
  var docEl = doc.documentElement,
    resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
    recalc = function () {
      var clientWidth = docEl.clientWidth;
      if (!clientWidth) return;
      docEl.style.fontSize = 20 * (clientWidth / 320) + 'px';
    };

  if (!doc.addEventListener) return;
  win.addEventListener(resizeEvt, recalc, false);
  doc.addEventListener('DOMContentLoaded', recalc, false);
})(document, window);
</script>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="applicable-devive" content="mobile">
<meta content="yes" name="apple-mobile-web-app-capable">
<meta content="telephone=no" name="format-detection">
<link href="css/app.css" rel="stylesheet">
</head>
<body>
<article>
	<template v-if="current=='mall'">
		<section class="WX_V3_banner"><img src="img/banner_6.jpg"></section>

		<section class="WX_V3_mall_info">
			<table>
				<tr><td>婚礼喜糖大礼包盒A组</td><td><div>仅剩 <b>5</b> 件 <span>2018-05-17 截止</span></div></td></tr>
				<tr><td>1998积分<del>2890</del></td><td><label class="WX_V3_level_5"><i style="background-image:url(img/level_5.png)"></i>钻石会员8.5折</label></td></tr>
			</table>
		</section>

		<section class="WX_V3_mall_item">
			<header>详细说明:</header>
			<blockquote>
				e袋洗，上门取送，专业洗衣，满10减10，低至两元即可洗衣哦～<br>
				e袋洗高品质的O2O洗衣服务，优质的按件清洗，随时随地上门服务。需要洗衣时，仅需APP/微信下单、预约时间地点，就会有专业的上门服务人员按时上门收取衣服。经过15道专业清洗工序后，7天内将熨烫平整的衣服送回<br>
				服饰、鞋类、家纺、皮具清洗，e袋洗统统帮你搞定。洗衣就用e袋洗，让生活多份自在！<br>
				使用流程<br>
				1.下载e袋洗APP或者打开微信关注e袋洗<br>微信公众号：ewashing<br>
				2.微信：点击会员中心-个人中心-登录-我的-优惠券，添加券码激活即可
				  APP：点击我的-登录-优惠券--兑换优惠券，添加券码激活即可
				3.下单付款时立减10元
			</blockquote>
		</section>

		<section class="WX_V3_mall_item tips">
			<header>温馨提示:</header>
			<blockquote>
				<ul>
					<li>除商品本身不能正常兑换外，商品一经兑换，一律不退还金币，请用户兑换前仔细参照使用规则、使用说明、有效期等重要信息；</li>
					<li>对于每位用户限兑一次的商品，若发现多个用户账号使用相同手机号或收货地址兑换同一商品，则自动取消订单，被扣除的金币不退还；</li>
					<li>通过非法途径获得金币后进行的正常兑换行为，或不按商品使用规则进行兑换，商家有权不提供服务；</li>
					<li>凡以不正当手段（包括但不限于作弊、扰乱系统、实施网络攻击等）进行兑换，平台有权终止该次兑换。</li>
				</ul>
			</blockquote>
		</section>

		<a class="WX_V3_mall_btns"><i class=""></i> 兑换结束</a>
		<a v-on:click="current='pay'" class="WX_V3_mall_btns active"><i class=""></i> 立即兑换</a>


	</template>


	<div v-if="current=='pay'" class="WX_V3_pay">
		<header>
			<table>
				<tr><td>收货人：{{address.address[address.current].name}}</td><td>{{address.address[address.current].mobile}}</td></tr>
				<tr><td colspan="2"><a v-on:click="address.isShow=true"><i class="i_map_marker"></i><span>收货地址：{{address.address[address.current].address}}</span><i class="i_arrow_right"></i></a></td></tr>
			</table>
		</header>

		<section class="WX_V3_pay_order">
			<div>
				<table>
						<td>
							<img data-echo="img/mall_1.png">
						</td>
						<td>
							<h2>婚礼喜糖大礼包盒A组婚礼喜糖大礼包盒A组</h2>
							<label class="WX_V3_level_5"><i data-echo-background="img/level_5.png"></i>8.5折</label><span><b>{{spinner.price * spinner.num}}</b>积分</span>
							<div class="spinner">
								<a v-on:click="spinnerFn(0)" v-bind:class="{'disabled':spinner.spinnerBtn}"></a><input v-model="spinner.num" type="number"><a v-on:click="spinnerFn(1)" v-bind:class="{'disabled':spinner.spinnerBtnAdd}"></a>
							</div>
							<div>最多兑换：<b>{{spinner.max}}</b> | 最少兑换：<b>{{spinner.min}}</b> </div>
							<div><a v-on:click="current='paySuccess'"><i class="i_ok_o"></i> 立即兑换</a></div>
						</td>
				</table>
			</div>
		</section>
	</div>


	<div v-if="current=='paySuccess'" class="WX_V3_pay_success">
		<header>
			<table>
				<tr><td><i class="i_ok_o"></i>恭喜您，兑换成功！</td></tr>
				<tr><td>订单编号：1008 1231 1230<br>订单时间：2017-05-17 14:30</td></tr>
			</table>
		</header>

		<section class="WX_V3_pay_success_nav">
			<table>
				<td>
					<a href="">
						<i class="i_shopping_cart"></i>
						继续兑换
					</a>
				</td>
				<td>
					<a href="">
						<i class="i_file"></i>
						兑换记录
					</a>
				</td>
				<td>
					<a href="">
						<i class="i_data"></i>
						赚取积分
					</a>
				</td>
			</table>
		</section>
	</div>



	<div v-show="address.isShow" style="display:none">
		<address-component v-bind:data="address" v-on:address="addressFn"></address-component>
	</div>






	<footer class="WX_V3_footer">
		<nav>
			<a href="" class="active"><i class="i_home"></i>首页</a>
			<a href=""><i class="i_gift_2"><sup class="WX_V3_badge">22</sup></i>活动</a>
			<a href=""><i class="i_reserve"><sup class="WX_V3_badge">8</sup></i>预约</a>
			<a href=""><i class="i_assistant"><sup class="WX_V3_badge"></sup></i>助手</a>
			<a href=""><i class="i_my"><sup class="WX_V3_badge"></sup></i>我的</a>
		</nav>
	</footer>

	<section class="WX_V3_poweredby">&copy; Powered by 樱桃互动</section>



</article>

<script src="js/vue.min.js"></script>
<script src="js/zepto.min.js"></script>
<script src="js/echo.js"></script>
<script src="js/app.js"></script>
<script src="js/require.js"></script>
<script>
var v3 = new V3();

var	APP = new Vue({
	el: 'article',
	data: {
		current: 'pay',
		spinner: {
			max: 50,
			min: 2,
			num: 2,
			price: 1988,
			spinnerBtn: true,
			spinnerBtnAdd: false
		},
		address: {
			isShow: false,
			isManage: false,
			isError: false,
			current: 0,
			addressForm: {
				isShow: false,
				sex: 'women'
			},
			address: [{
				"id": 1,
				"address": "漕河泾孵化中心A座503-505",
				"name": "张三",
				"sex": "女士",
				"mobile": "13912345678"
			},{
				"id": 2,
				"address": "漕河泾孵化中心A座503-505",
				"name": "张三",
				"sex": "先生",
				"mobile": "13912345678"
			},{
				"id": 3,
				"address": "漕河泾孵化中心A座503-505",
				"name": "张三",
				"sex": "先生",
				"mobile": "13912345678"
			}]
		}
	},
	components: {
		'address-component': addressComponent
	},
	watch: {
		spinner: {
			handler: function(val, oldval){
				this.spinnerFn(2);
			},
			deep: true
		}
	},
	methods: {
		addressFn: function(d){
			console.log(d.addressForm)
			$.post('/', d.addressForm, function() {

			})
		},
		spinnerFn: function(i) {
			var num = this.spinner.num;

			if (i == 0) {
				this.spinner.num = --num;

				if (num != this.spinner.max) {
					this.spinner.spinnerBtnAdd = false
				}

				if (num == this.spinner.min) {
					this.spinner.spinnerBtn = true
				}
			}
			if (i == 1) {
				
				this.spinner.num = ++num;

				if (num != this.spinner.min) {
					this.spinner.spinnerBtn = false
				}

				if (num == this.spinner.max) {
					this.spinner.spinnerBtnAdd = true
				}
			}

			if (i == 2) {
				if(this.spinner.num == ''){
					this.spinner.spinnerBtn = true;
					this.spinner.spinnerBtnAdd = true;
					return
				}
				if (this.spinner.num <= this.spinner.min){
					this.spinner.num = this.spinner.min;
					this.spinner.spinnerBtn = true;
				}else{
					this.spinner.spinnerBtn = false;
				}
				if (this.spinner.num >= this.spinner.max){
					this.spinner.num = this.spinner.max;
					this.spinner.spinnerBtnAdd = true;
				}else{
					this.spinner.spinnerBtnAdd = false;
				}


			}

		}


	}
});

</script>
</body>
</html>